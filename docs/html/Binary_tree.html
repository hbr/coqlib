<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Binary_tree</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Binary_tree</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Core</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Lists.List</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Equal.Notations</span>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Make</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">A</span>:<span class="id" title="var">ANY</span>)  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">E</span>:<span class="id" title="var">ANY</span>). 
<br/>
</div>

<div class="doc">
<a name="lab22"></a><h1 class="section">List</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">List</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">L</span>: <span class="id" title="keyword">Set</span> := <span class="id" title="var">list</span> <span class="id" title="var">A.t</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Permutation</span>: <span class="id" title="var">L</span> → <span class="id" title="var">L</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">perm_empty</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Permutation</span> [] []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">perm_prefix</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">Permutation</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> → <span class="id" title="var">Permutation</span> (<span class="id" title="var">x</span>::<span class="id" title="var">a</span>) (<span class="id" title="var">x</span>::<span class="id" title="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">perm_swap</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">a</span>,  <span class="id" title="var">Permutation</span> (<span class="id" title="var">x</span>::<span class="id" title="var">y</span>::<span class="id" title="var">a</span>) (<span class="id" title="var">y</span>::<span class="id" title="var">x</span>::<span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">perm_transitive</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>,  <span class="id" title="var">Permutation</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> → <span class="id" title="var">Permutation</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> → <span class="id" title="var">Permutation</span> <span class="id" title="var">a</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">List</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab23"></a><h1 class="section">Tree</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Tree</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">t</span>: <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Leaf</span>: <span class="id" title="var">t</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span>: <span class="id" title="var">E.t</span> → <span class="id" title="var">t</span> → <span class="id" title="var">A.t</span> → <span class="id" title="var">t</span> → <span class="id" title="var">t</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_Node</span> (<span class="id" title="var">a</span>:<span class="id" title="var">t</span>): <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Leaf</span> ⇒ <span class="id" title="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_Leaf</span> (<span class="id" title="var">a</span>:<span class="id" title="var">t</span>): <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Leaf</span> ⇒ <span class="id" title="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">extra</span> (<span class="id" title="var">a</span>:<span class="id" title="var">t</span>): <span class="id" title="var">is_Node</span> <span class="id" title="var">a</span> → <span class="id" title="var">E.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Leaf</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">nd</span> ⇒ <span class="id" title="var">ex_falso</span> <span class="id" title="var">nd</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">change_extra</span> (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">t</span>): <span class="id" title="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Leaf</span> ⇒ <span class="id" title="var">Leaf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">t1</span> <span class="id" title="var">x</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">x</span> <span class="id" title="var">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">node_equal_leaf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>} {<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>} {<span class="id" title="var">x</span>:<span class="id" title="var">A.t</span>} {<span class="id" title="var">u</span> <span class="id" title="var">v</span>:<span class="id" title="var">t</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eq</span>:<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> = <span class="id" title="var">Leaf</span>): <span class="id" title="var">A</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">leaf_equal_node</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>} {<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>} {<span class="id" title="var">x</span>:<span class="id" title="var">A.t</span>} {<span class="id" title="var">u</span> <span class="id" title="var">v</span>:<span class="id" title="var">t</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eq</span>:<span class="id" title="var">Leaf</span> = <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">u</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span>): <span class="id" title="var">A</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">use_node_equal</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>:<span class="id" title="keyword">Prop</span>} (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">u1</span> <span class="id" title="var">u2</span>:<span class="id" title="var">t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Node</span> <span class="id" title="var">e1</span> <span class="id" title="var">t1</span> <span class="id" title="var">x1</span> <span class="id" title="var">u1</span> = <span class="id" title="var">Node</span> <span class="id" title="var">e2</span> <span class="id" title="var">t2</span> <span class="id" title="var">x2</span> <span class="id" title="var">u2</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">e1</span>=<span class="id" title="var">e2</span> → <span class="id" title="var">x1</span>=<span class="id" title="var">x2</span> → <span class="id" title="var">t1</span>=<span class="id" title="var">t2</span> → <span class="id" title="var">u1</span>=<span class="id" title="var">u2</span> → <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" title="var">A</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Tree</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab24"></a><h1 class="section">Inorder Sequence</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Inorder</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">R</span>: <span class="id" title="var">Tree.t</span> → <span class="id" title="var">list</span> <span class="id" title="var">A.t</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">leaf</span>: <span class="id" title="var">R</span> <span class="id" title="var">Tree.Leaf</span> []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">node</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">c</span> <span class="id" title="var">t1</span> <span class="id" title="var">l1</span> <span class="id" title="var">x</span> <span class="id" title="var">t2</span> <span class="id" title="var">l2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t1</span> <span class="id" title="var">l1</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t2</span> <span class="id" title="var">l2</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c</span> <span class="id" title="var">t1</span> <span class="id" title="var">x</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">l1</span> ++ <span class="id" title="var">x</span> :: <span class="id" title="var">l2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">make</span> (<span class="id" title="var">t</span>:<span class="id" title="var">Tree.t</span>): <span class="id" title="var">list</span> <span class="id" title="var">A.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Tree.Leaf</span> ⇒ []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Tree.Node</span> <span class="id" title="var">c</span> <span class="id" title="var">t</span> <span class="id" title="var">x</span> <span class="id" title="var">u</span> ⇒ <span class="id" title="var">make</span> <span class="id" title="var">t</span> ++ <span class="id" title="var">x</span> :: (<span class="id" title="var">make</span> <span class="id" title="var">u</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">of_list</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span>:<span class="id" title="var">Tree.t</span>) (<span class="id" title="var">l</span>:<span class="id" title="var">list</span> <span class="id" title="var">A.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">l</span> = <span class="id" title="var">make</span> <span class="id" title="var">t</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">to_list</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span>:<span class="id" title="var">Tree.t</span>) (<span class="id" title="var">l</span>:<span class="id" title="var">list</span> <span class="id" title="var">A.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">l</span> = <span class="id" title="var">make</span> <span class="id" title="var">t</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">make_correct</span> (<span class="id" title="var">t</span>:<span class="id" title="var">Tree.t</span>): <span class="id" title="var">R</span> <span class="id" title="var">t</span> (<span class="id" title="var">make</span> <span class="id" title="var">t</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">unique</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span>:<span class="id" title="var">Tree.t</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span>:<span class="id" title="var">list</span> <span class="id" title="var">A.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t</span> <span class="id" title="var">a</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t</span> <span class="id" title="var">b</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> = <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Inorder</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab25"></a><h1 class="section">Rotations</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Rotation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">R</span>: <span class="id" title="var">Tree.t</span> → <span class="id" title="var">Tree.t</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">leaf</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">Tree.Leaf</span> <span class="id" title="var">Tree.Leaf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">left</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">c3</span> <span class="id" title="var">c4</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c1</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c2</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c3</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c4</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">right</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">c3</span> <span class="id" title="var">c4</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c1</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c2</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">b</span>) <span class="id" title="var">y</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c3</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c4</span> <span class="id" title="var">b</span> <span class="id" title="var">y</span> <span class="id" title="var">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">node</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">x</span> <span class="id" title="var">t11</span> <span class="id" title="var">t12</span> <span class="id" title="var">t21</span> <span class="id" title="var">t22</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t11</span> <span class="id" title="var">t12</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t21</span> <span class="id" title="var">t22</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c1</span> <span class="id" title="var">t11</span> <span class="id" title="var">x</span> <span class="id" title="var">t21</span>) (<span class="id" title="var">Tree.Node</span> <span class="id" title="var">c2</span> <span class="id" title="var">t12</span> <span class="id" title="var">x</span> <span class="id" title="var">t22</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">transitive</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> → <span class="id" title="var">R</span> <span class="id" title="var">t2</span> <span class="id" title="var">t3</span> → <span class="id" title="var">R</span> <span class="id" title="var">t1</span> <span class="id" title="var">t3</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">reflexive</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span>:<span class="id" title="var">Tree.t</span>), <span class="id" title="var">R</span> <span class="id" title="var">t</span> <span class="id" title="var">t</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">to_node</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>:<span class="id" title="var">Tree.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Tree.is_Node</span> <span class="id" title="var">u</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Tree.is_Node</span> <span class="id" title="var">v</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">symmetric</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">u</span> <span class="id" title="var">v</span>:<span class="id" title="var">Tree.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">v</span> <span class="id" title="var">u</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">change_extra</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span>:<span class="id" title="var">Tree.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">u</span> (<span class="id" title="var">Tree.change_extra</span> <span class="id" title="var">e</span> <span class="id" title="var">v</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">change_extra1</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span>:<span class="id" title="var">Tree.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">w</span> = <span class="id" title="var">Tree.change_extra</span> <span class="id" title="var">e</span> <span class="id" title="var">v</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span>.<br/>

<br/>
</div>

<div class="doc">
Rotations keep the inorder sequence. The proof recurses over all
  constructors of a rotation.

<div class="paragraph"> </div>

  The left and right rotation use the associativity of list append.

<div class="paragraph"> </div>

  The node construction uses the fact that rotations of the sons keep their
  inorder sequence. Using this we can transform an inorder sequence of the
  node before the rotation into the same inorder sequence of the node after
  rotation.

<div class="paragraph"> </div>

  Transitivity is a simple application of two rotations keeping the inorder
  sequence.
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">keep_inorder</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> <span class="id" title="var">u</span>:<span class="id" title="var">Tree.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">R</span> <span class="id" title="var">t</span> <span class="id" title="var">u</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Inorder.R</span> <span class="id" title="var">t</span> <span class="id" title="var">l</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Inorder.R</span> <span class="id" title="var">u</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Rotation</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab26"></a><h1 class="section">Basic Definitions</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">basic_definitions</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">tree</span>: <span class="id" title="keyword">Set</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span>: <span class="id" title="var">tree</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span>:  <span class="id" title="var">E.t</span> → <span class="id" title="var">tree</span> → <span class="id" title="var">A.t</span> →  <span class="id" title="var">tree</span> → <span class="id" title="var">tree</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_Node</span> (<span class="id" title="var">t</span>:<span class="id" title="var">tree</span>): <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒ <span class="id" title="var">False</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">node_not_empty</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span>(<span class="id" title="var">a</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">i</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>: <span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Node</span> <span class="id" title="var">i</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span> ≠ <span class="id" title="var">Empty</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_node</span> (<span class="id" title="var">t</span>:<span class="id" title="var">tree</span>): {<span class="id" title="var">is_Node</span> <span class="id" title="var">t</span>} + {~ <span class="id" title="var">is_Node</span> <span class="id" title="var">t</span>} :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">return</span> {<span class="id" title="var">is_Node</span> <span class="id" title="var">t</span>} + {~ <span class="id" title="var">is_Node</span> <span class="id" title="var">t</span>} <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Empty</span> ⇒ <span class="id" title="tactic">right</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span>:<span class="id" title="var">False</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="tactic">left</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Element</span>: <span class="id" title="var">tree</span> → <span class="id" title="var">A.t</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">element_node</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>, <span class="id" title="var">Element</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">a</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Extra</span>: <span class="id" title="var">tree</span> → <span class="id" title="var">E.t</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">extra_node</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>, <span class="id" title="var">Extra</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">e</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">extra_is_node</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>), <span class="id" title="var">Extra</span> <span class="id" title="var">t</span> <span class="id" title="var">e</span> → <span class="id" title="var">is_Node</span> <span class="id" title="var">t</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">left_son</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">tree</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">nd</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">t1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">right_son</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">tree</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">nd</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">element</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">A.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">nd</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">extra</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">E.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">nd</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">left_son_correct</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t1</span> = <span class="id" title="var">left_son</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">right_son_correct</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t2</span> = <span class="id" title="var">right_son</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">element_correct</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> = <span class="id" title="var">element</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">extra_correct</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e</span> = <span class="id" title="var">extra</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">I</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">node_injective_extra</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t11</span> <span class="id" title="var">t12</span> <span class="id" title="var">t21</span> <span class="id" title="var">t22</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Node</span> <span class="id" title="var">e1</span> <span class="id" title="var">t11</span> <span class="id" title="var">a1</span> <span class="id" title="var">t12</span> = <span class="id" title="var">Node</span> <span class="id" title="var">e2</span> <span class="id" title="var">t21</span> <span class="id" title="var">a2</span> <span class="id" title="var">t22</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">e1</span> = <span class="id" title="var">e2</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">node_injective_element</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t11</span> <span class="id" title="var">t12</span> <span class="id" title="var">t21</span> <span class="id" title="var">t22</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Node</span> <span class="id" title="var">e1</span> <span class="id" title="var">t11</span> <span class="id" title="var">a1</span> <span class="id" title="var">t12</span> = <span class="id" title="var">Node</span> <span class="id" title="var">e2</span> <span class="id" title="var">t21</span> <span class="id" title="var">a2</span> <span class="id" title="var">t22</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">a1</span> = <span class="id" title="var">a2</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">node_injective_left_son</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t11</span> <span class="id" title="var">t12</span> <span class="id" title="var">t21</span> <span class="id" title="var">t22</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Node</span> <span class="id" title="var">e1</span> <span class="id" title="var">t11</span> <span class="id" title="var">a1</span> <span class="id" title="var">t12</span> = <span class="id" title="var">Node</span> <span class="id" title="var">e2</span> <span class="id" title="var">t21</span> <span class="id" title="var">a2</span> <span class="id" title="var">t22</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t11</span> = <span class="id" title="var">t21</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">node_injective_right_son</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">a1</span> <span class="id" title="var">a2</span>:<span class="id" title="var">A.t</span>) (<span class="id" title="var">e1</span> <span class="id" title="var">e2</span>:<span class="id" title="var">E.t</span>) (<span class="id" title="var">t11</span> <span class="id" title="var">t12</span> <span class="id" title="var">t21</span> <span class="id" title="var">t22</span>:<span class="id" title="var">tree</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Node</span> <span class="id" title="var">e1</span> <span class="id" title="var">t11</span> <span class="id" title="var">a1</span> <span class="id" title="var">t12</span> = <span class="id" title="var">Node</span> <span class="id" title="var">e2</span> <span class="id" title="var">t21</span> <span class="id" title="var">a2</span> <span class="id" title="var">t22</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">t12</span> = <span class="id" title="var">t22</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">basic_definitions</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab27"></a><h1 class="section">Height</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">height</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Height</span>: <span class="id" title="var">tree</span> → <span class="id" title="var">nat</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">empty_height</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Height</span> <span class="id" title="var">Empty</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">node_height</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">t1</span> <span class="id" title="var">h1</span> <span class="id" title="var">t2</span> <span class="id" title="var">h2</span> <span class="id" title="var">a</span> <span class="id" title="var">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Height</span> <span class="id" title="var">t1</span> <span class="id" title="var">h1</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Height</span> <span class="id" title="var">t2</span> <span class="id" title="var">h2</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Height</span> (<span class="id" title="var">Node</span> <span class="id" title="var">i</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) (1 + <span class="id" title="var">max</span> <span class="id" title="var">h1</span> <span class="id" title="var">h2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">height</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒ 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">t1</span> <span class="id" title="var">_</span> <span class="id" title="var">t2</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 + <span class="id" title="var">max</span> (<span class="id" title="var">height</span> <span class="id" title="var">t1</span>) (<span class="id" title="var">height</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">height_is_only_height</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Height</span> <span class="id" title="var">t_</span> <span class="id" title="var">h</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h</span> = <span class="id" title="var">height</span> <span class="id" title="var">t_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">height_is_height</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>, <span class="id" title="var">Height</span> <span class="id" title="var">t_</span> (<span class="id" title="var">height</span> <span class="id" title="var">t_</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">height_is_unique</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">h1</span> <span class="id" title="var">h2</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Height</span> <span class="id" title="var">t_</span> <span class="id" title="var">h1</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Height</span> <span class="id" title="var">t_</span> <span class="id" title="var">h2</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h1</span> = <span class="id" title="var">h2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">height</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab28"></a><h1 class="section">Leftmost and Rightmost</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">leftmost_and_rightmost</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Leftmost</span>: <span class="id" title="var">tree</span> → <span class="id" title="var">A.t</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">lm_noleft</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span>, <span class="id" title="var">Leftmost</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">Empty</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">lm_left</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Leftmost</span> <span class="id" title="var">t1</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Leftmost</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Rightmost</span>: <span class="id" title="var">tree</span> → <span class="id" title="var">A.t</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rm_noright</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span>, <span class="id" title="var">Rightmost</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">Empty</span>) <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">rm_right</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rightmost</span> <span class="id" title="var">t2</span> <span class="id" title="var">x</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rightmost</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">leftmost_is_node</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">A.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Leftmost</span> <span class="id" title="var">t_</span> <span class="id" title="var">a</span> → <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">rightmost_is_node</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">A.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rightmost</span> <span class="id" title="var">t_</span> <span class="id" title="var">a</span> → <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">leftmost</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">A.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">return</span> <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">A.t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">nd</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">is_node</span> <span class="id" title="var">t1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">left</span>  <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">leftmost</span> <span class="id" title="var">t1</span> (<span class="id" title="var">nd</span>:<span class="id" title="var">is_Node</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">right</span> <span class="id" title="var">_</span>  ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">leftmost_correct</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">nd</span>:<span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Leftmost</span> <span class="id" title="var">t_</span> (<span class="id" title="var">leftmost</span> <span class="id" title="var">t_</span> <span class="id" title="var">nd</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">rightmost</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">A.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">return</span> <span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span> → <span class="id" title="var">A.t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">match</span> <span class="id" title="var">nd</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">is_node</span> <span class="id" title="var">t2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">left</span>  <span class="id" title="var">nd</span> ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">rightmost</span> <span class="id" title="var">t2</span> (<span class="id" title="var">nd</span>:<span class="id" title="var">is_Node</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">right</span> <span class="id" title="var">p</span>  ⇒ <span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">rightmost_correct</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">nd</span>:<span class="id" title="var">is_Node</span> <span class="id" title="var">t_</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Rightmost</span> <span class="id" title="var">t_</span> (<span class="id" title="var">rightmost</span> <span class="id" title="var">t_</span> <span class="id" title="var">nd</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">leftmost_and_rightmost</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab29"></a><h1 class="section">Inorder Sequence</h1>

</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">inorder_sequence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">Inorder</span>: <span class="id" title="var">tree</span> → <span class="id" title="var">list</span> <span class="id" title="var">A.t</span> → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">empty_inorder</span>: <span class="id" title="var">Inorder</span> <span class="id" title="var">Empty</span> []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">node_inorder</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">t1</span> <span class="id" title="var">xs1</span> <span class="id" title="var">t2</span> <span class="id" title="var">xs2</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Inorder</span> <span class="id" title="var">t1</span> <span class="id" title="var">xs1</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Inorder</span> <span class="id" title="var">t2</span> <span class="id" title="var">xs2</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Inorder</span> (<span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span>) (<span class="id" title="var">xs1</span> ++ <span class="id" title="var">a</span> :: <span class="id" title="var">xs2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">inorder</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>): <span class="id" title="var">list</span> <span class="id" title="var">A.t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t_</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Empty</span> ⇒ []<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Node</span> <span class="id" title="var">e</span> <span class="id" title="var">t1</span> <span class="id" title="var">a</span> <span class="id" title="var">t2</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inorder</span> <span class="id" title="var">t1</span> ++ <span class="id" title="var">a</span> :: <span class="id" title="var">inorder</span> <span class="id" title="var">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">inorder_correct</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>, <span class="id" title="var">Inorder</span> <span class="id" title="var">t_</span> (<span class="id" title="var">inorder</span> <span class="id" title="var">t_</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <span class="id" title="var">inorder_unique</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">t_</span>:<span class="id" title="var">tree</span>) (<span class="id" title="var">xs</span>:<span class="id" title="var">list</span> <span class="id" title="var">A.t</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Inorder</span> <span class="id" title="var">t_</span> <span class="id" title="var">xs</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xs</span> = <span class="id" title="var">inorder</span> <span class="id" title="var">t_</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Same_inorder</span> (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>:<span class="id" title="var">tree</span>): <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inorder</span> <span class="id" title="var">t1</span> = <span class="id" title="var">inorder</span> <span class="id" title="var">t2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">inorder_sequence</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Make</span>.<br/>
</div>
<hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>